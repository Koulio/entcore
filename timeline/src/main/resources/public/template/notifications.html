<app-title>
	<h1 data-reload class="application-title"><i18n>timeline.title</i18n></h1>
</app-title>
<div data-ng-controller="FlashMessages" class="twelve cell">
    <div class="flashmsg" ng-repeat="message in messages.all"
        ng-class="message.color"
        ng-style="{ 'background-color': message.customColor }">
        <i class="close-2x right-magnet" tooltip="timeline.mark.flashmsg" ng-click="markMessage(message)"></i>
        <div bind-html="message.contents[currentLanguage]"></div>
    </div>
</div>
<div data-ng-controller="Timeline" class="twelve cell">



<div class="row drop-down-block">

	<div class="drop-down-label" ng-if="filtered.notificationTypes.length > 0">
		<label><i18n>filters.title</i18n></label>
		<i class="arrow"></i>
	</div>

	<div class="drop-down-content">
		<div class="chips">
			<label class="chip">
				<span><i18n>filters.all.none</i18n></span>
				<input type="checkbox" ng-model="type.selected" ng-change="type.apply()" />
			</label>
			<label class="chip [[type.data.toLowerCase()]]" ng-class="{ selected: type.selected }" ng-repeat="type in (filtered.notificationTypes = notificationTypes.all)" >
				<i class="[[type.data.toLowerCase()]] type"></i>
				<span translate content="[[type.data.toLowerCase()]]"></span>
				<input type="checkbox" ng-model="type.selected" ng-change="type.apply()" />
			</label>
		</div>
		<div class="drop-up-label">
			<label><i18n>filters.close</i18n></label>
			<i class="arrow"></i>
		</div>
	</div>

</div>




	<div data-ng-repeat="notification in notifications.all track by notification._id" class="row notification [[notification.type.toLowerCase()]]" bottom-scroll="loadPage()">
		<article ng-class="{ 'unread': isUnRead(notification) }">
			<div class="row">
				<div class="avatar">
					<i class="system-avatar" ng-if="!notification.sender"></i>
					<img ng-src="/userbook/avatar/[[notification.sender]]?thumbnail=100x100" ng-if="notification.sender" />
					<i class="sticker app type [[notification.type.toLowerCase()]]"></i>
				</div>
				<div class="content horizontal-spacing">
					<p class="inline" bind-html="notification.message"></p>
				</div>
			</div>
			<div class="notification-date">
				<em class="low-importance right-magnet">[[formatDate(notification.date.$date)]]</em>
			</div>
		</article>
		<div class="notification-actions" ng-class="{'opened': notification.opened}" ng-if="showActions(notification)">
			<div class="opener" ng-click="notification.opened = !notification.opened">
				<i class="left-open"></i>
			</div>
			<div class="actions">
				<div ng-repeat="(name, action) in actions" ng-show="!action.condition || action.condition(notification)" class="action [[ name ]]">
					<i class="[[name]]"></i>
					<a ng-click="action.action(notification)" ng-disabled="notification[action.doneProperty]">
						[[ notification[action.doneProperty] ? lang.translate(action.doneLabel) : lang.translate(action.label) ]]
					</a>
				</div>
			</div>
		</div>
	</div>
	<div class="row notification" ng-show="notifications.loading">
		<h1 class="reduce-block-eight nomargin"><i18n>loading</i18n></h1>
	</div>
</div>
